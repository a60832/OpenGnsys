#!/bin/bash
TIME1=$SECONDS


#Load engine configurator from engine.cfg file.
#Carga el configurador del engine desde el fichero engine.cfg
[ -z $OGENGINECONFIGURATE ] && source /opt/opengnsys/etc/engine.cfg

# Clear temporary file used as log track by httpdlog
# Limpia los ficheros temporales usados como log de seguimiento para httpdlog
echo " " > $OGLOGSESSION; echo " " > $OGLOGCOMMAND; echo " " > ${OGLOGCOMMAND}.tmp

# Registro de inicio de ejecución
#echo "[START Interface ] Run this command: $0 $*" | tee -a $OGLOGSESSION $OGLOGFILE
echo "$MSG_INTERFACE_START $0 $*" | tee -a $OGLOGSESSION $OGLOGFILE

echo -e "\n Instrucciones a ejecutar: *****************************" >>  $OGLOGFILE
cat  $1 >> $OGLOGFILE


echo -e "\n Salida de las instrucciones: *****************************" >>  $OGLOGFILE
chmod +x $1
$1 &>> $OGLOGCOMMAND
RETVAL=$?



TIME=$[SECONDS-TIME1]
if [ $RETVAL == 0 ]
then
	echo "[100] Duracion de la operacion $[TIME/60]m $[TIME%60]s" | tee -a $OGLOGSESSION $OGLOGFILE
else
	echo "ERROR no operacion no realizada" | tee -a $OGLOGSESSION $OGLOGFILE
fi


# Registro de fin de ejecución
#echo "[END Interface] Command finished with this code:  $RETVAL" | tee -a $OGLOGSESSION $OGLOGFILE
echo "$MSG_INTERFACE_END $RETVAL" | tee -a $OGLOGSESSION $OGLOGFILE



exit $RETVAL
