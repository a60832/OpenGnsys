SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL';

CREATE SCHEMA IF NOT EXISTS `eac` DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ;
USE `eac`;

-- -----------------------------------------------------
-- Table `eac`.`arranques`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `eac`.`arranques` ;

CREATE  TABLE IF NOT EXISTS `eac`.`arranques` (
  `id_arranque` VARCHAR(7) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `descripcion` VARCHAR(50) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NULL DEFAULT NULL ,
  PRIMARY KEY (`id_arranque`) )
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish_ci;


-- -----------------------------------------------------
-- Data for table `eac`.`arranques`
-- -----------------------------------------------------
SET AUTOCOMMIT=0;
INSERT INTO `arranques` (`id_arranque`, `descripcion`) VALUES ('1', '1disk MBR');
INSERT INTO `arranques` (`id_arranque`, `descripcion`) VALUES ('11', '1disk 1part');
INSERT INTO `arranques` (`id_arranque`, `descripcion`) VALUES ('12', '1disk 2part');
INSERT INTO `arranques` (`id_arranque`, `descripcion`) VALUES ('13', '1disk 3part');
INSERT INTO `arranques` (`id_arranque`, `descripcion`) VALUES ('pxe', NULL);

COMMIT;

-- -----------------------------------------------------
-- Table `eac`.`aulas`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `eac`.`aulas` ;

CREATE  TABLE IF NOT EXISTS `eac`.`aulas` (
  `id_aula` TINYINT(4) NULL ,
  `descripcion` VARCHAR(25) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NULL DEFAULT NULL ,
  `subred` VARCHAR(11) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NULL DEFAULT NULL ,
  PRIMARY KEY (`id_aula`) )
ENGINE = InnoDB
AUTO_INCREMENT = 0
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish_ci;


-- -----------------------------------------------------
-- Data for table `eac`.`aulas`
-- -----------------------------------------------------
SET AUTOCOMMIT=0;
INSERT INTO `aulas` (`id_aula`, `descripcion`, `subred`) VALUES (0, 'aula sin asignar', NULL);
INSERT INTO `aulas` (`id_aula`, `descripcion`, `subred`) VALUES (1, 'uno', NULL);
INSERT INTO `aulas` (`id_aula`, `descripcion`, `subred`) VALUES (2, 'dos', NULL);
INSERT INTO `aulas` (`id_aula`, `descripcion`, `subred`) VALUES (3, 'tres', NULL);

COMMIT;

-- -----------------------------------------------------
-- Table `eac`.`equipos`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `eac`.`equipos` ;

CREATE  TABLE IF NOT EXISTS `eac`.`equipos` (
  `ip` VARCHAR(15) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `hostname` VARCHAR(32) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `mac` VARCHAR(18) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `startpage` VARCHAR(50) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NULL DEFAULT 'default.sh' ,
  `arranque` VARCHAR(7) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NULL DEFAULT 'pxe' ,
  `aula` TINYINT(4) NULL DEFAULT 0 ,
  UNIQUE INDEX `mac` (`mac` ASC) ,
  UNIQUE INDEX `ip` (`ip` ASC) ,
  PRIMARY KEY (`ip`) ,
  INDEX `fk_equipos_arranques` (`arranque` ASC) ,
  INDEX `fk_equipos_aulas` (`aula` ASC) ,
  CONSTRAINT `fk_equipos_arranques`
    FOREIGN KEY (`arranque` )
    REFERENCES `eac`.`arranques` (`id_arranque` )
    ON DELETE RESTRICT
    ON UPDATE CASCADE,
  CONSTRAINT `fk_equipos_aulas`
    FOREIGN KEY (`aula` )
    REFERENCES `eac`.`aulas` (`id_aula` )
    ON DELETE RESTRICT
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish_ci;


-- -----------------------------------------------------
-- Table `eac`.`caches`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `eac`.`caches` ;

CREATE  TABLE IF NOT EXISTS `eac`.`caches` (
  `mount` VARCHAR(15) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL COMMENT 'punto de montaje' ,
  `size` INT(30) NOT NULL COMMENT 'tamaï¿½o en mb' ,
  `ip` VARCHAR(15) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  PRIMARY KEY (`ip`) ,
  INDEX `fk_caches_equipos` (`ip` ASC) ,
  CONSTRAINT `fk_caches_equipos`
    FOREIGN KEY (`ip` )
    REFERENCES `eac`.`equipos` (`ip` )
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish_ci
COMMENT = 'control de las caches';


-- -----------------------------------------------------
-- Table `eac`.`imagenes`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `eac`.`imagenes` ;

CREATE  TABLE IF NOT EXISTS `eac`.`imagenes` (
  `directory` VARCHAR(100) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `name` VARCHAR(50) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `size` INT(15) NOT NULL ,
  `info` TEXT CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `ip` VARCHAR(15) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  PRIMARY KEY (`directory`, `name`, `ip`) ,
  INDEX `fk_imagenes_caches` (`ip` ASC) ,
  CONSTRAINT `fk_imagenes_caches`
    FOREIGN KEY (`ip` )
    REFERENCES `eac`.`caches` (`ip` )
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish_ci;


-- -----------------------------------------------------
-- Table `eac`.`kernelparameters`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `eac`.`kernelparameters` ;

CREATE  TABLE IF NOT EXISTS `eac`.`kernelparameters` (
  `vga` ENUM('791','788') CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL DEFAULT '788' ,
  `acpi` ENUM('off','on') CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL DEFAULT 'off' ,
  `pci` ENUM('msi','nomsi') CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL DEFAULT 'nomsi' ,
  `ip` VARCHAR(15) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  PRIMARY KEY (`ip`) ,
  INDEX `fk_kernelparameters_equipos` (`ip` ASC) ,
  CONSTRAINT `fk_kernelparameters_equipos`
    FOREIGN KEY (`ip` )
    REFERENCES `eac`.`equipos` (`ip` )
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish_ci;


-- -----------------------------------------------------
-- Table `eac`.`log`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `eac`.`log` ;

CREATE  TABLE IF NOT EXISTS `eac`.`log` (
  `dia` DATE NOT NULL ,
  `hora` VARCHAR(8) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `tiempo_proceso` VARCHAR(8) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `comando` VARCHAR(100) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `parametros` VARCHAR(300) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `ip` VARCHAR(15) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  PRIMARY KEY (`dia`, `hora`, `comando`, `ip`) ,
  INDEX `fk_log_equipos` (`ip` ASC) ,
  CONSTRAINT `fk_log_equipos`
    FOREIGN KEY (`ip` )
    REFERENCES `eac`.`equipos` (`ip` )
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish_ci;


-- -----------------------------------------------------
-- Table `eac`.`tareas_servidor`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `eac`.`tareas_servidor` ;

CREATE  TABLE IF NOT EXISTS `eac`.`tareas_servidor` (
  `comando` VARCHAR(30) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `parametros` VARCHAR(200) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `descripcion` VARCHAR(15) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NULL DEFAULT NULL ,
  `ip` VARCHAR(42) CHARACTER SET 'utf8' COLLATE 'utf8_spanish_ci' NOT NULL ,
  `id_proceso` INT(4) NULL DEFAULT NULL ,
  `finalizado` INT(4) NOT NULL ,
  PRIMARY KEY (`comando`, `parametros`, `ip`) )
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish_ci;



SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
